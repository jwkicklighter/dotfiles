" Vundle
set nocompatible              " be iMproved, required
filetype off                  " required

set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" Let Vundle manage itself
Plugin 'VundleVim/Vundle.vim'

" Misc Plugins
Plugin 'rking/ag.vim'
Plugin 'Shougo/vimproc.vim'
Plugin 'airblade/vim-gitgutter'
Plugin 'mattn/emmet-vim'
Plugin 'scrooloose/nerdtree'
Plugin 'jistr/vim-nerdtree-tabs'
Plugin 'scrooloose/syntastic'
Plugin 'terryma/vim-multiple-cursors'
Plugin 'Xuyuanp/nerdtree-git-plugin'
Plugin 'dsawardekar/wordpress.vim'
Plugin 'Raimondi/delimitMate.git'       " Insert mode auto-completion for quotes, parens, brackets, etc.
Plugin 'Yggdroot/indentLine'            " Indent guides
Plugin 'scrooloose/nerdcommenter'
Plugin 'tpope/vim-surround'
Plugin 'ap/vim-css-color'
Plugin 'terryma/vim-expand-region'
Plugin 'michaeljsmith/vim-indent-object'
Plugin 'justinmk/vim-sneak'
Plugin 'tommcdo/vim-exchange'
Plugin 'pbrisbin/vim-mkdir'             " Automatically create any non-existent directories before writing the buffer.
Plugin 'vim-airline/vim-airline'
Plugin 'vim-airline/vim-airline-themes'
Plugin 'vim-ctrlspace/vim-ctrlspace'

" Syntax Plugins
Plugin 'SyntaxComplete'
Plugin 'tpope/vim-rails'
Plugin 'vim-ruby/vim-ruby'
Plugin 'tpope/vim-cucumber'
Plugin 'tpope/vim-endwise'
Plugin 'plasticboy/vim-markdown'
Plugin 'kchmck/vim-coffee-script'
Plugin 'cakebaker/scss-syntax.vim'
Plugin 'StanAngeloff/php.vim'
Plugin 'jelera/vim-javascript-syntax'
Plugin 'othree/javascript-libraries-syntax.vim'
Plugin 'myhere/vim-nodejs-complete'
Plugin 'nginx.vim'
Plugin 'tpope/vim-git'

" Color Schemes
Plugin 'jwkicklighter/vim-schemes'

" Git Plugins
"Plugin 'mattn/webapi-vim'               " Needed for gist-vim
"Plugin 'mattn/gist-vim'
"Plugin 'gregsexton/gitv'
"Plugin 'motemen/git-vim'
"Plugin 'tpope/vim-fugitive'

" Disabled Plugins
"Plugin 'pangloss/vim-javascript'
"Plugin 'MarcWeber/vim-addon-mw-utils'
"Plugin 'tomtom/tlib_vim'
"Plugin 'tyru/open-browser.vim'
"Plugin 'reedes/vim-wordy'
"Plugin 'ervandew/supertab.git'
"Plugin 'flazz/vim-colorschemes'
"Plugin 'nanotech/jellybeans.vim'
"Plugin 'zenorocha/dracula-theme', {'rtp': 'vim/'}
"Plugin 'antlypls/vim-colors-codeschool'
"Plugin 'wellsjo/wellsokai.vim'
"Plugin 'junegunn/limelight.vim'
"Plugin 'xoria256.vim'
"Plugin 'whatyouhide/vim-gotham'
"Plugin 'zeis/vim-kolor'
"Plugin 'elzr/vim-json'
"Plugin 'dag/vim2hs'
"Plugin 'eagletmt/ghcmod-vim'
"Plugin 'ahw/vim-hooks'
"Plugin 'majutsushi/tagbar'
"Plugin 'SirVer/ultisnips'
"Plugin 'honza/vim-snippets'
"Plugin 'godlygeek/tabular'
"Plugin 'ctrlpvim/ctrlp.vim'
"Plugin 'shawncplus/phpcomplete.vim'
"Plugin 'Lokaltog/vim-powerline'
"Plugin 'myusuf3/numbers.vim'

call vundle#end()            " required
filetype plugin indent on    " required

" Airline
let g:airline#extensions#tabline#enabled = 1
let g:airline_powerline_fonts = 1

" CtrlSpace
if has("gui_running")
  let g:CtrlSpaceSymbols = { "File": "◯", "CTab": "▣", "Tabs": "▢" }
endif
let g:CtrlSpaceSearchTiming = 0
hi CtrlSpaceSelected term=reverse ctermfg=187 ctermbg=23 cterm=bold
hi CtrlSpaceNormal term=NONE ctermfg=244 ctermbg=232 cterm=NONE
hi CtrlSpaceFound ctermfg=220 ctermbg=NONE cterm=bold

" AutoCMD stuff
autocmd BufWritePost *.hs GhcModCheckAndLintAsync

" Detect platform for keybindings
if has("unix")
  let s:uname = system("uname -s")
  if s:uname == "Darwin\n"
    let s:keyplatform = "mac"
  else
    let s:keyplatform = "linux"
  endif
else
  let s:keyplatform = "windows"
endif

if has("autocmd") && exists("+omnifunc")
	autocmd Filetype *
		    \	if &omnifunc == "" |
		    \		setlocal omnifunc=syntaxcomplete#Complete |
		    \	endif
endif

" CUSTOM SETTINGS
color fox.dark
syntax on
set number                       " Enable line numbers
set tabstop=2
set shiftwidth=2
set softtabstop=2
set expandtab
set autoindent
set smartindent
set gfn=Hack:h13
set linespace=2                  " Adds space in between lines
set conceallevel=0               " Do not hide any quotes
set nofoldenable                 " disable folding
set laststatus=2                 " Always show the statusline
set encoding=utf-8               " Necessary to show Unicode glyphs

set autoread                     " Read changes to files outside vim
set magic
set showmatch                    " Highlight matching brackets
set incsearch
set ignorecase                   " Ignore case for searches by default
set smartcase
set scrolloff=999                " Cause cursor to stay in middle of screen
set clipboard=unnamed            " Use system keyboard
set hidden                       " Required by ctrlspace
set splitbelow                   " Open new splits below the current buffer
set splitright                   " Open new splits to the right of the current buffer

set backspace=indent,eol,start   " Fix backspace not deleting tabs, also make delimiteMate work

" Some plugin setting
"let g:ctrlp_show_hidden=1
let delimitMate_expand_cr = 1
let g:UltiSnipsExpandTrigger="<tab>"
let g:UltiSnipsJumpForwardTrigger="<c-b>"
let g:UltiSnipsJumpBackwardTrigger="<c-z>"
let g:vim_markdown_folding_disabled = 1

" Syntastic checkers
let g:syntastic_ruby_checkers=['rubocop', 'reek']
let g:syntastic_haml_checkers=['haml']
let g:syntastic_scss_checkers=['scss_lint']

" Auto-focus Tagbar when opened
"let g:tagbar_autofocus = 1

" Adds indentation guide like Sublime
let g:indentLine_char = '|'
let g:indentLine_enabled = 1

" Gist Settings
let g:gist_detect_filetype = 1          " Detect for gists filetype automatically
let g:gist_open_browser_after_post = 1  " Open browser after creating gist
let g:gist_show_privates = 1            " Let :Gist -l show private gists
let g:gist_post_private = 1             " Set gists as private by default

" NERDTree/NERDTreeTabs

" CUSTOM KEYBINDINGS
" Use <Space> to open prompt
nmap <Space> :
vmap <Space> :

" Use Ctrl+<key> shortcuts for tabs
nmap <C-S-tab> :tabprevious<cr>
nmap <C-tab> :tabnext<cr>
vmap <C-S-tab> :tabprevious<cr>
vmap <C-tab> :tabnext<cr>
imap <C-S-tab> <C-o>:tabprevious<cr>
imap <C-tab> <C-o>:tabnext<cr>

" Bettor split navigation
map <C-j> <C-W>j
map <C-k> <C-W>k
map <C-h> <C-W>h
map <C-l> <C-W>l

" Open CtrlSpace with CMD+Shift+A
if s:keyplatform == "mac"
  map <D-A> :CtrlSpace<cr>
else
  map <C-A> :CtrlSpace<cr>
endif

" Open CtrlP with CMD+Shift+O, like IntelliJ
if s:keyplatform == "mac"
  map <D-O> :CtrlSpace O<cr>
else
  map <C-O> :CtrlSpace O<cr>
endif

" Rebuild tags with \b
nnoremap <Leader>b :execute '!ctags -R'<cr>

" Open Syntastic error window
nnoremap <Leader>e :Errors<cr>

" Duplicate line with CMD+D, like IntelliJ
if s:keyplatform == "mac"
  map <D-d> :t.<cr>
else
  map <C-d> :t.<cr>
endif

" Open NERDTree with CMD+\ or CTRL+\
if s:keyplatform == "mac"
  map <D-\> :NERDTreeTabsToggle<cr>
else
  map <C-\> :NERDTreeTabsToggle<cr>
endif

" CMD+/ to toggle line comments
" Requires nerdcommenter plugin
if (s:keyplatform == "mac" && has("gui_running"))
  map <D-/> \c<Space>
else
  map <C-_> \c<Space>
endif

" CMD+k/CMD+j to move lines up/down
if s:keyplatform == "mac"
  nnoremap <D-J> :m .+1<CR>==
  nnoremap <D-K> :m .-2<CR>==
  inoremap <D-J> <Esc>:m .+1<CR>==gi
  inoremap <D-K> <Esc>:m .-2<CR>==gi
  vnoremap <D-J> :m '>+1<CR>gv=gv
  vnoremap <D-K> :m '<-2<CR>gv=gv
else
  nnoremap <C-J> :m .+1<CR>==
  nnoremap <C-K> :m .-2<CR>==
  inoremap <C-J> <Esc>:m .+1<CR>==gi
  inoremap <C-K> <Esc>:m .-2<CR>==gi
  vnoremap <C-J> :m '>+1<CR>gv=gv
  vnoremap <C-K> :m '<-2<CR>gv=gv
endif

" CMD+e to expand emmet snippet
" Requires emmet plugin
if s:keyplatform == "mac"
  imap <D-E> <C-y>,
else
  imap <C-E> <C-y>,
endif

" \zz to toggle keeping cursor in middle of screen
:nnoremap <Leader>zz :let &scrolloff=999-&scrolloff<CR>
