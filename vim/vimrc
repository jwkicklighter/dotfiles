" Vundle
set nocompatible              " be iMproved, required
filetype off                  " required

set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" Let Vundle manage itself
Plugin 'VundleVim/Vundle.vim'

" Misc Plugins
Plugin 'Shougo/vimproc.vim'
"Plugin 'godlygeek/tabular'
Plugin 'ctrlpvim/ctrlp.vim'
Plugin 'airblade/vim-gitgutter'
"Plugin 'SirVer/ultisnips'
"Plugin 'honza/vim-snippets'
Plugin 'mattn/emmet-vim'
Plugin 'majutsushi/tagbar'
Plugin 'scrooloose/nerdtree'
Plugin 'jistr/vim-nerdtree-tabs'
Plugin 'scrooloose/syntastic'
Plugin 'terryma/vim-multiple-cursors'
Plugin 'Xuyuanp/nerdtree-git-plugin'
Plugin 'dsawardekar/wordpress.vim'
"Plugin 'shawncplus/phpcomplete.vim'
Plugin 'tyru/open-browser.vim'
Plugin 'MarcWeber/vim-addon-mw-utils'
Plugin 'tomtom/tlib_vim'
Plugin 'Raimondi/delimitMate.git'
Plugin 'Yggdroot/indentLine'
Plugin 'scrooloose/nerdcommenter'
Plugin 'tpope/vim-surround'
Plugin 'ap/vim-css-color'
Plugin 'terryma/vim-expand-region'
Plugin 'michaeljsmith/vim-indent-object'
Plugin 'myusuf3/numbers.vim'
Plugin 'tacahiroy/ctrlp-funky'
Plugin 'justinmk/vim-sneak'
Plugin 'tommcdo/vim-exchange'
Plugin 'pbrisbin/vim-mkdir'
Plugin 'reedes/vim-wordy'
Plugin 'Lokaltog/vim-powerline'
"Plugin 'ahw/vim-hooks'

" Git Plugins
Plugin 'mattn/webapi-vim'               " Needed for gist-vim
Plugin 'mattn/gist-vim'
Plugin 'gregsexton/gitv'
Plugin 'motemen/git-vim'
Plugin 'tpope/vim-fugitive'

" Syntax Plugins
Plugin 'SyntaxComplete'
Plugin 'tpope/vim-rails'
Plugin 'vim-ruby/vim-ruby'
Plugin 'tpope/vim-cucumber'
Plugin 'tpope/vim-endwise'
Plugin 'plasticboy/vim-markdown'
Plugin 'kchmck/vim-coffee-script'
Plugin 'cakebaker/scss-syntax.vim'
Plugin 'StanAngeloff/php.vim'
Plugin 'pangloss/vim-javascript'
Plugin 'jelera/vim-javascript-syntax'
Plugin 'othree/javascript-libraries-syntax.vim'
Plugin 'myhere/vim-nodejs-complete'
Plugin 'elzr/vim-json'
Plugin 'nginx.vim'
Plugin 'tpope/vim-git'
"Plugin 'dag/vim2hs'
"Plugin 'eagletmt/ghcmod-vim'

" Color Schemes
Plugin 'jwkicklighter/vim-schemes'
"Plugin 'flazz/vim-colorschemes'
"Plugin 'nanotech/jellybeans.vim'
"Plugin 'zenorocha/dracula-theme', {'rtp': 'vim/'}
"Plugin 'antlypls/vim-colors-codeschool'
"Plugin 'wellsjo/wellsokai.vim'
"Plugin 'junegunn/limelight.vim'
"Plugin 'xoria256.vim'
"Plugin 'whatyouhide/vim-gotham'
"Plugin 'zeis/vim-kolor'

" Disabled Plugins
"Plugin 'ervandew/supertab.git'

call vundle#end()            " required
filetype plugin indent on    " required

"let $PYTHONPATH='/usr/lib/python2.7/'
"python from powerline.vim import setup as powerline_setup
"python powerline_setup()
"python del powerline_setup

" AutoCMD stuff
autocmd BufWritePost *.hs GhcModCheckAndLintAsync

" Detect platform for keybindings
if has("unix")
  let s:uname = system("uname -s")
  if s:uname == "Darwin\n"
    let s:keyplatform = "mac"
  else
    let s:keyplatform = "linux"
  endif
else
  let s:keyplatform = "windows"
endif


" CUSTOM SETTINGS
color fox.dark
syntax on
set number                       " Enable line numbers
set tabstop=2
set shiftwidth=2
set softtabstop=2
set expandtab
set autoindent
set smartindent
set gfn=Hack:h14
set linespace=2                  " Adds space in between lines
set conceallevel=0               " Do not hide any quotes
set nofoldenable                 " disable folding
set laststatus=2                 " Always show the statusline
set encoding=utf-8               " Necessary to show Unicode glyphs

set autoread                     " Read changes to files outside vim
set magic
set showmatch                    " Highlight matching brackets
set incsearch
set ignorecase                   " Ignore case for searches by default
set smartcase
set scrolloff=999                " Cause cursor to stay in middle of screen
set clipboard=unnamed            " Use system keyboard

set backspace=indent,eol,start   " Fix backspace not deleting tabs, also make delimiteMate work

" Some plugin setting
let g:ctrlp_show_hidden=1
let delimitMate_expand_cr = 1
let g:UltiSnipsExpandTrigger="<tab>"
let g:UltiSnipsJumpForwardTrigger="<c-b>"
let g:UltiSnipsJumpBackwardTrigger="<c-z>"
let g:vim_markdown_folding_disabled = 1

" Syntastic checkers
let g:syntastic_ruby_checkers=['rubocop', 'reek']
let g:syntastic_haml_checkers=['haml']
let g:syntastic_scss_checkers=['scss_lint']

" Auto-focus Tagbar when opened
let g:tagbar_autofocus = 1

" Adds indentation guide like Sublime
let g:indentLine_char = '|'
let g:indentLine_enabled = 1

" Gist Settings
let g:gist_detect_filetype = 1          " Detect for gists filetype automatically
let g:gist_open_browser_after_post = 1  " Open browser after creating gist
let g:gist_show_privates = 1            " Let :Gist -l show private gists
let g:gist_post_private = 1             " Set gists as private by default

" NERDTree/NERDTreeTabs

" CUSTOM KEYBINDINGS
" Use <Space> to open prompt
nmap <Space> :
vmap <Space> :

" Use Ctrl+<key> shortcuts for tabs
nmap <C-S-tab> :tabprevious<cr>
nmap <C-tab> :tabnext<cr>
vmap <C-S-tab> :tabprevious<cr>
vmap <C-tab> :tabnext<cr>
imap <C-S-tab> <C-o>:tabprevious<cr>
imap <C-tab> <C-o>:tabnext<cr>

" Use Ctrl+m for <ESC>
imap <C-w> <ESC>
vmap <C-w> <ESC>

" Open CtrlP with CMD+Shift+O, like IntelliJ
if s:keyplatform == "mac"
  map <D-O> :CtrlP<cr>
else
  map <C-O> :CtrlP<cr>
endif

" Open CtrlPTag with CMD+Shift+B
"map <D-B> :CtrlPTag<cr>

" Rebuild tags with \b
nnoremap <Leader>b :execute '!ctags -R'<cr>

" Open Tagbar with CMD+[
if s:keyplatform == "mac"
  map <D-[> :execute 'TagbarToggle'<cr>
else
  map <C-[> :execute 'TagbarToggle'<cr>
endif

" Find current word with CtrlPFunky
"nnoremap <Leader>fU :execute 'CtrlPFunky ' . expand('<cword>')<Cr>

" Open Syntastic error window
nnoremap <Leader>e :Errors<cr>

" Duplicate line with CMD+D, like IntelliJ
if s:keyplatform == "mac"
  map <D-d> :t.<cr>
else
  map <C-d> :t.<cr>
endif

" Open NERDTree with CMD+\ or CTRL+\
if s:keyplatform == "mac"
  map <D-\> :NERDTreeTabsToggle<cr>
else
  map <C-\> :NERDTreeTabsToggle<cr>
endif

" CMD+/ to toggle line comments
" Requires nerdcommenter plugin
if (s:keyplatform == "mac" && has("gui_running"))
  map <D-/> \c<Space>
else
  map <C-_> \c<Space>
endif

" CMD+k/CMD+j to move lines up/down
if s:keyplatform == "mac"
  nnoremap <D-j> :m .+1<CR>==
  nnoremap <D-k> :m .-2<CR>==
  inoremap <D-j> <Esc>:m .+1<CR>==gi
  inoremap <D-k> <Esc>:m .-2<CR>==gi
  vnoremap <D-j> :m '>+1<CR>gv=gv
  vnoremap <D-k> :m '<-2<CR>gv=gv
else
  nnoremap <C-j> :m .+1<CR>==
  nnoremap <C-k> :m .-2<CR>==
  inoremap <C-j> <Esc>:m .+1<CR>==gi
  inoremap <C-k> <Esc>:m .-2<CR>==gi
  vnoremap <C-j> :m '>+1<CR>gv=gv
  vnoremap <C-k> :m '<-2<CR>gv=gv
endif

" CMD+e to expand emmet snippet
" Requires emmet plugin
if s:keyplatform == "mac"
  imap <D-E> <C-y>,
else
  imap <C-E> <C-y>,
endif

" \zz to toggle keeping cursor in middle of screen
:nnoremap <Leader>zz :let &scrolloff=999-&scrolloff<CR>
