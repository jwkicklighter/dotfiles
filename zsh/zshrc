# Path to your oh-my-zsh installation.
export ZSH=$HOME/.oh-my-zsh
export DOTFILES=$HOME/dotfiles
export ZSH_PLUGINS=$DOTFILES/zsh-plugins
export RUST_SRC_PTH=/usr/local/src/rust/src

# Source a .env file in the home directory to
# avoid adding any API keys to git
source $HOME/.env

# Clone this theme: git@github.com:jwkicklighter/oh-my-zsh-powerline-theme.git
# Copy powerline.zsh-theme into .oh-my-zsh/themes/ (install_in_omz.sh should do this)

# Install and set terminal to 1 of these fonts: git@github.com:powerline/fonts.git
# (Any Powerline font is actually fine, even if not from that repo)
# (I use "12pt Hack" for Regular & Non-ASCII in iTerm2)
autoload -U add-zsh-hook
ZSH_THEME="spaceship"

# Custom Plugins (clone both into .oh-my-zsh/custom/plugins/[plugin name])
# git@github.com:yonchu/grunt-zsh-completion.git                Completes from Gruntfile.js
# git@github.com:zsh-users/zsh-history-substring-search.git     Searches history using typed text
# git://github.com/zsh-users/zsh-syntax-highlighting.git        Highlights terminal commands

plugins=(osx git git-flow git-extras github ruby rails wd bundler docker docker-compose gem node npm brew zsh-syntax-highlighting zsh-history-substring-search kubectl yarn systemd rake-fast jsontools)

source $ZSH/oh-my-zsh.sh

# User configuration

# You may need to manually set your language environment
# export LANG=en_US.UTF-8

# Preferred editor for local and remote sessions
export EDITOR='vim'

# Compilation flags
# export ARCHFLAGS="-arch x86_64"

# ssh
# export SSH_KEY_PATH="~/.ssh/dsa_id"

# Misc Aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
alias c='clear'
alias szshrc='source $HOME/.zshrc'
alias vzshrc='$EDITOR $HOME/.zshrc'
alias td='wd'
alias s='spotify play/pause'
alias sup='sudo -E zsh'
alias vimr='sudo -E vim'
alias push='pushover -T $PUSHOVER_APP_TOKEN -u $PUSHOVER_USER_KEY'

finished () {
    push -t "Script Complete" "$@ has finished running"
}


# Java
javar () {
  filename=$1
  basename="${filename%.*}"
  javac $filename && java $basename
}

# Vagrant
alias vu='vagrant up'
alias vh='vagrant halt'
alias vs='vagrant suspend'
alias vst='vagrant status'

# Mac
cleanopenwith='/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -kill -r -domain local -domain user;killall Finder;echo "Open With has been rebuilt, Finder will relaunch"'

# MacVim
alias v='mvim --remote-tab-silent'
alias vtab='mvim --remote-tab-silent'

# Arch
alias y='yaourt'
alias xclip='xclip -selection clipboard'

# Grunt
alias grserve='grunt server'

# Git
alias gs='git status'
alias gf='git fetch'
alias gff='git flow feature'
alias gffc='git flow feature checkout'
alias gffp='git flow feature publish'
alias gffs='git flow feature start'
alias gfff='git flow feature finish'
alias gfh='git flow hotfix'
alias gfhc='git flow hotfix checkout'
alias gfhs='git flow hotfix start'
alias gfhf='git flow hotfix finish'
alias gfr='git flow release'
alias gfrs='git flow release start'
alias gfrf='git flow release finish'
alias gl='git log --all --graph --decorate --oneline --simplify-by-decoration'
alias gt='git tag'
alias gcuc='git commit -m "Update changelog"'
alias gffp.='git flow feature publish $(git branch | grep \* | sed -e "s/\* feature\///g")'

# Sublime Text
alias st.='st .'

# Android
alias androiddevicemonitor='$HOME/dev/android-sdk-macosx/tools/monitor'
alias adb-net='adb tcpip 5555'
alias adb-n6='adb connect 192.168.1.44'
alias adb-usb='adb usb'

# Docker
alias dcu='docker-compose up -d'
alias dcd='docker-compose down'
alias dcr='docker-compose run --rm'
alias dcre='docker-compose restart'

alias dctu='docker-compose -f docker-compose.test.yml up -d'
alias dctd='docker-compose -f docker-compose.test.yml down'
alias dctr='docker-compose -f docker-compose.test.yml run --rm'
alias dctre='docker-compose -f docker-compose.test.yml restart'

alias dps='docker ps'
alias dps='docker ps'
alias dpsa='docker ps -a'
alias drm='docker rm'
alias drma='docker rm $(docker ps -aq)'

# ALL the bins!
export PATH="$HOME/sbin":$PATH
export PATH="/usr/local/bin":$PATH
export PATH=$PATH:"/usr/local/sbin"
export PATH=$PATH:"/usr/bin"
export PATH=$PATH:"/usr/sbin"
export PATH=$PATH:"/bin"
export PATH=$PATH:"/sbin"
export PATH=$PATH:"$HOME/bin"
export PATH=$PATH:"$HOME/bin/sbt"
export PATH=$PATH:"$HOME/.cabal/bin"
export PATH=$PATH:"$HOME/.cargo/bin"

# The next line updates PATH for the Google Cloud SDK.
if [ -f '/Users/jordan/dev/python/google-cloud-sdk/path.zsh.inc' ]; then source '/Users/jordan/dev/python/google-cloud-sdk/path.zsh.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/Users/jordan/dev/python/google-cloud-sdk/completion.zsh.inc' ]; then source '/Users/jordan/dev/python/google-cloud-sdk/completion.zsh.inc'; fi

# Only export ruby gem path if ruby is installed
if command -v ruby > /dev/null 2>&1; then
  export PATH="$(ruby -e 'print Gem.user_dir')/bin:$PATH"
fi

# Only export docker-machine variables if docker-machine is installed
#if command -v docker-machine > /dev/null 2>&1 && [ $(docker-machine status) = "Running" ]; then
  #eval $(docker-machine env)
#fi

#Mono
export MONO_GAC_PREFIX="/usr/local"

# NPM
export PATH=$PATH:"/usr/local/share/npm/bin"

# Ruby
#export PATH=$PATH:"$HOME/.rvm/bin"
#[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"

# Add GHC 7.10.2 to the PATH, via https://ghcformacosx.github.io/
#export GHC_DOT_APP="/Applications/ghc-7.10.2.app"
#if [ -d "$GHC_DOT_APP" ]; then
  #export PATH="${HOME}/.local/bin:${HOME}/.cabal/bin:${GHC_DOT_APP}/Contents/bin:${PATH}"
#fi

mkc () {
    mkdir -p "$@" && cd "$@"
}

# Go Forward in Git history
# Usage: gofwd v1.2.7
gofwd() {
  git checkout `git rev-list --topo-order HEAD.."$*" | tail -1`
}

# Go Backward in Git history
# Usage: goback
alias goback='git checkout HEAD~'

function t() {
  # Defaults to 3 levels deep, do more with `t 5` or `t 1`
  # pass additional args after
  tree -I '.git|node_modules|bower_components|.DS_Store' --dirsfirst --filelimit 15 -L ${1:-3} -aC $2
}

function docker-ip() {
  docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' "$@"
}

function convert-to-mp3() {
  ffmpeg -i "$1" -f mp3 -acodec libmp3lame -ab 192000 -ar 44100 "$2"
}

# SPACESHIP THEME CUSTOMIZATION
SPACESHIP_PROMPT_ORDER=(
  time
  user
  host
  dir
  git
  venv
  kubecontext
  exec_time
  line_sep
  jobs
  exit_code
  char
)
